<form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
  <div mat-dialog-content>
    <section class="row">
      <!-- Name -->
      <mat-form-field class="col-md-4">
        <input matInput placeholder="Pseudo" i18n-placeholder formControlName="name" required />
      </mat-form-field>
    </section>

    <h5 i18n>Un peu de vous</h5>

    <section class="row">
      <!-- Gender -->
      <mat-form-field class="col-md-4">
        <mat-label i18n>Je suis</mat-label>
        <mat-select matNativeControl formControlName="gender">
          <mat-option [value]="'OTHER'" i18n>Autre</mat-option>
          <mat-option [value]="'FEMALE'" i18n>Femme</mat-option>
          <mat-option [value]="'MALE'" i18n>Homme</mat-option>
        </mat-select>
      </mat-form-field>
      <!-- Birthdate -->
      <mat-form-field class="col-md-3">
        <input
          matInput
          [matDatepicker]="picker"
          [max]="today"
          placeholder="Date de naissance"
          i18n-placeholder
          formControlName="birthdate"
        />
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
      </mat-form-field>
      <div class="col-md-1 ui-visibility-container">
        <button type="button" mat-button color="accent" (click)="onSwitchControlValue('showBirthdate')">
          <app-ui-visibility
            class="ui-visibility"
            [visible]="profileForm.value.privacy.showBirthdate"
          ></app-ui-visibility>
        </button>
      </div>
    </section>

    <h5 i18n>Contact</h5>

    <section class="row">
      <!-- Email -->
      <mat-form-field class="col-md-3">
        <input matInput type="email" formControlName="email" placeholder="Courriel" i18n-placeholder email required />
      </mat-form-field>
      <div class="col-md-1 ui-visibility-container">
        <button type="button" mat-button color="accent" (click)="onSwitchControlValue('showEmail')">
          <app-ui-visibility class="ui-visibility" [visible]="profileForm.value.privacy.showEmail"></app-ui-visibility>
        </button>
      </div>
      <!-- Phone -->
      <mat-form-field class="col-md-3">
        <input matInput type="phone" placeholder="Téléphone" i18n-placeholder formControlName="phoneNumber" />
      </mat-form-field>
      <div class="col-md-1 ui-visibility-container">
        <button type="button" mat-button color="accent" (click)="onSwitchControlValue('showPhoneNumber')">
          <app-ui-visibility
            class="ui-visibility"
            [visible]="profileForm.value.privacy.showPhoneNumber"
          ></app-ui-visibility>
        </button>
      </div>
    </section>

    <h5 i18n>Où êtes-vous&nbsp;?</h5>

    <section class="row">
      <!-- District -->
      <mat-form-field class="col-md-4">
        <input matInput placeholder="Quartier" i18n-placeholder formControlName="district" />
      </mat-form-field>
      <!-- City -->
      <mat-form-field class="col-md-4">
        <input matInput placeholder="Ville" i18n-placeholder formControlName="city" />
      </mat-form-field>
      <!-- Country -->
      <mat-form-field class="col-md-4">
        <mat-label i18n>Pays</mat-label>
        <mat-select matNativeControl formControlName="country" required>
          <mat-option *ngFor="let country of countries" [value]="country.isoCode" i18n>
            {{ country?.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </section>

    <h5 i18n>Board Game Geek</h5>

    <p i18n>
      Entrez votre pseudo BGG afin de pouvoir récupérer votre liste de jeux&nbsp;! Si ce n'est pas encore fait, nous
      vous invitons à visiter
      <a href="https://boardgamegeek.com/">boardgamegeek.com</a>
      .
    </p>
    <section class="row">
      <!-- BGG Name -->
      <mat-form-field class="col-md-4">
        <input matInput placeholder="Pseudo BGG" i18n-placeholder formControlName="bggName" />
      </mat-form-field>
      <button
        mat-button
        type="button"
        color="primary"
        class="col-md-3"
        (click)="onGetBggGames()"
        [disabled]="profileForm.value.bggName?.length < 3 || isLoadingBggGames"
      >
        <fa-icon [icon]="faSearch"></fa-icon>
        <span i18n>Rechercher</span>
      </button>
      <div class="col-md-1 ui-visibility-container">
        <button type="button" mat-button color="accent" (click)="onSwitchControlValue('showBggName')">
          <app-ui-visibility
            class="ui-visibility"
            [visible]="profileForm.value.privacy.showBggName"
          ></app-ui-visibility>
        </button>
      </div>
    </section>

    <!-- BGG Games's list -->

    <div *ngIf="games || isLoadingBggGames">
      <app-ui-spinner *ngIf="isLoadingBggGames" [message]="'BoardGameGeek'"></app-ui-spinner>
      <div *ngIf="!isLoadingBggGames">
        <p>Liste de vos jeux&nbsp;:</p>
        <div class="imgs-container">
          <figure *ngFor="let game of games">
            <a [attr.href]="'https://boardgamegeek.com/boardgame/' + game.gameId">
              <img src="{{ game.thumbnail }}" title="{{ game.name }}" alt="{{ game.name }}" />
            </a>
          </figure>
        </div>
      </div>
    </div>
  </div>

  <!-- Action buttons -->

  <div mat-dialog-actions>
    <p *ngIf="!profileForm.valid" i18n>* champs obligatoires</p>
    <button mat-stroked-button type="button" color="primary" (click)="onClose()" i18n="">
      Annuler
    </button>
    <button mat-raised-button type="button" color="primary" [disabled]="!profileForm.valid" (click)="onSubmit()">
      <fa-icon *ngIf="profileForm.valid" [icon]="faCheck"></fa-icon>
      <fa-icon *ngIf="!profileForm.valid" [icon]="faTimesCircle"></fa-icon>
      <span *ngIf="!this.profile.id" i18n>Créer</span>
      <span *ngIf="this.profile.id" i18n>Modifier</span>
    </button>
  </div>
</form>
